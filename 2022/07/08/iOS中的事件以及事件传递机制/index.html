<!DOCTYPE html><html class="appearance-auto" lang="en"><head><meta charset="UTF-8"><title>iOSä¸­çš„äº‹ä»¶ä»¥åŠäº‹ä»¶ä¼ é€’æœºåˆ¶</title><meta name="description" content="ä¸ä»¥åŠŸåˆ©ä¸ºç›®çš„."><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/images/avatar.jpeg"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="å‰è¨€iOS ä¸­æœ‰ 8 ç§äº‹ä»¶ï¼Œæœ¬æ–‡é‡ç‚¹ä»‹ç»è§¦æ‘¸äº‹ä»¶çš„ä¼ é€’æœºåˆ¶ä¸å“åº”æµç¨‹ã€‚å¯ä»¥å¸¦ç€ä¸€ä¸‹é—®é¢˜è¿›è¡Œé˜…è¯»ï¼š

iOS ä¸­æœ‰å“ªäº›äº‹ä»¶ç±»å‹ï¼Œè°æ¥è¿›è¡Œäº‹ä»¶çš„å“åº”ï¼Œæ€ä¹ˆæ¥å“åº”å‘¢ï¼Ÿ
è§¦æ‘¸äº‹ä»¶çš„ä¼ é€’ä¸å“åº”æµç¨‹
hitTest æ–¹æ³•çš„ä½œç”¨ï¼Œå®ƒæœ‰ä»€ä¹ˆå®è·µåœºæ™¯ï¼Ÿ
UIControl ä¸ UIGestureRecognizer ä¹Ÿèƒ½å“åº”è§¦æ‘¸äº‹ä»¶ï¼ŒUIResponder çš„å“åº”æ–¹å¼æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ

å“åº”è€… &amp;amp; å“åº”è€…é“¾
å“åº”è€…å³ UIResponder class çš„ä¸€ä¸ªå®ä¾‹ï¼›
å“åº”è€…é“¾ä¸ºå“åº”è€…ç»„æˆçš„ä¸€ä¸ªé“¾å¼ç»“æ„ï¼Œä¸åŒçš„é“¾å¼ç»“æ„ç»„åˆèµ·æ¥çœ‹èµ·æ¥åƒä¸€ä¸ªå€’è¿‡æ¥çš„æ ‘å½¢ç»“æ„ã€‚
UIResponder ä¸­åŒ…å«äº†è®¸å¤šå¤„ç†äº‹ä»¶çš„æ–¹æ³•ï¼Œå¦‚æœæˆ‘ä»¬æƒ³åœ¨è¿™ä¸ªå¯¹è±¡é‡Œå“åº”äº‹ä»¶ï¼Œé‚£ä¹ˆé‡å†™è¿™ä¸ªæ–¹æ³•å³å¯ã€‚




UIViewï¼šå¦‚æœ view æ˜¯ UIViewCo.."><meta name="generator" content="Hexo 5.4.2">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="nihao' Blog" type="application/atom+xml">
</head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">nihao's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">iOSä¸­çš„äº‹ä»¶ä»¥åŠäº‹ä»¶ä¼ é€’æœºåˆ¶</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Click back to the top</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3><h3 class="is-inline-block"><a href="/about">About</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3><h3 class="is-inline-block"><a href="/about">About</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%93%8D%E5%BA%94%E8%80%85-amp-%E5%93%8D%E5%BA%94%E8%80%85%E9%93%BE"><span class="toc-text">å“åº”è€… &amp; å“åº”è€…é“¾</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6-amp-%E8%B0%81%E6%98%AF%E4%BA%8B%E4%BB%B6%E7%9A%84%E7%AC%AC%E4%B8%80%E5%93%8D%E5%BA%94%E8%80%85"><span class="toc-text">äº‹ä»¶ &amp; è°æ˜¯äº‹ä»¶çš„ç¬¬ä¸€å“åº”è€…</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E6%B5%81%E7%A8%8B"><span class="toc-text">è§¦æ‘¸äº‹ä»¶æµç¨‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BB%E6%89%BE%E6%9C%80%E4%BD%B3%E5%93%8D%E5%BA%94%E8%80%85"><span class="toc-text">å¯»æ‰¾æœ€ä½³å“åº”è€…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A6%E6%91%B8%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%93%8D%E5%BA%94%E4%BB%A5%E5%8F%8A%E4%BC%A0%E9%80%92"><span class="toc-text">è§¦æ‘¸äº‹ä»¶çš„å“åº”ä»¥åŠä¼ é€’</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#UIGestureRecognizer"><span class="toc-text">UIGestureRecognizer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#UIControl"><span class="toc-text">UIControl</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%AE%9E%E8%B7%B5"><span class="toc-text">åº”ç”¨å®è·µ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%A9%E5%A4%A7%E5%93%8D%E5%BA%94%E5%8C%BA%E5%9F%9F"><span class="toc-text">æ‰©å¤§å“åº”åŒºåŸŸ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B9%E6%8D%AE%E8%A7%A6%E6%91%B8%E5%AE%9E%E6%97%B6%E4%BF%AE%E6%94%B9-view-%E4%BD%8D%E7%BD%AE"><span class="toc-text">æ ¹æ®è§¦æ‘¸å®æ—¶ä¿®æ”¹ view ä½ç½®</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%97"><span class="toc-text">ğŸ”—</span></a></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/UI"><i class="tag post-item-tag">UI</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">iOSä¸­çš„äº‹ä»¶ä»¥åŠäº‹ä»¶ä¼ é€’æœºåˆ¶</h1><time class="has-text-grey" datetime="2022-07-08T09:49:00.000Z">2022-07-08</time><article class="mt-2 post-content"><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>iOS ä¸­æœ‰ 8 ç§äº‹ä»¶ï¼Œæœ¬æ–‡é‡ç‚¹ä»‹ç»è§¦æ‘¸äº‹ä»¶çš„ä¼ é€’æœºåˆ¶ä¸å“åº”æµç¨‹ã€‚å¯ä»¥å¸¦ç€ä¸€ä¸‹é—®é¢˜è¿›è¡Œé˜…è¯»ï¼š</p>
<ul>
<li>iOS ä¸­æœ‰å“ªäº›äº‹ä»¶ç±»å‹ï¼Œè°æ¥è¿›è¡Œäº‹ä»¶çš„å“åº”ï¼Œæ€ä¹ˆæ¥å“åº”å‘¢ï¼Ÿ</li>
<li>è§¦æ‘¸äº‹ä»¶çš„ä¼ é€’ä¸å“åº”æµç¨‹</li>
<li><code>hitTest</code> æ–¹æ³•çš„ä½œç”¨ï¼Œå®ƒæœ‰ä»€ä¹ˆå®è·µåœºæ™¯ï¼Ÿ</li>
<li><code>UIControl</code> ä¸ <code>UIGestureRecognizer</code> ä¹Ÿèƒ½å“åº”è§¦æ‘¸äº‹ä»¶ï¼Œ<code>UIResponder</code> çš„å“åº”æ–¹å¼æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ<span id="more"></span></li>
</ul>
<h2 id="å“åº”è€…-amp-å“åº”è€…é“¾"><a href="#å“åº”è€…-amp-å“åº”è€…é“¾" class="headerlink" title="å“åº”è€… &amp; å“åº”è€…é“¾"></a>å“åº”è€… &amp; å“åº”è€…é“¾</h2><ul>
<li>å“åº”è€…å³ <code>UIResponder class</code> çš„ä¸€ä¸ªå®ä¾‹ï¼›</li>
<li>å“åº”è€…é“¾ä¸ºå“åº”è€…ç»„æˆçš„ä¸€ä¸ªé“¾å¼ç»“æ„ï¼Œä¸åŒçš„é“¾å¼ç»“æ„ç»„åˆèµ·æ¥çœ‹èµ·æ¥åƒä¸€ä¸ªå€’è¿‡æ¥çš„æ ‘å½¢ç»“æ„ã€‚</li>
<li><code>UIResponder</code> ä¸­åŒ…å«äº†è®¸å¤šå¤„ç†äº‹ä»¶çš„æ–¹æ³•ï¼Œå¦‚æœæˆ‘ä»¬æƒ³åœ¨è¿™ä¸ªå¯¹è±¡é‡Œå“åº”äº‹ä»¶ï¼Œé‚£ä¹ˆé‡å†™è¿™ä¸ªæ–¹æ³•å³å¯ã€‚</li>
</ul>
<img src="/images/blog/responderChain.png" alt="A flow diagram: On the left, a sample app contains a label (UILabel), a text field for the user to input text (UITextField), and a button (UIButton) to  press after entering text in the field. On the right, the flow diagram shows how, after the user pressed the button, the event moves through the responder chainâ€”from UIView, to UIViewController, to UIWindow, UIApplication, and finally to UIApplicationDelegate." style="zoom:67%;">

<ul>
<li><strong>UIView</strong>ï¼šå¦‚æœ <code>view</code> æ˜¯ <code>UIViewController</code> çš„ <code>root view</code>ï¼Œä¸‹ä¸€ä¸ªå“åº”è€…ä¸º <code>UIViewController</code>ï¼Œå¦åˆ™ä¸‹ä¸€ä¸ªå“åº”è€…ä¸º<code>superview</code>ã€‚</li>
<li><strong>UIViewController</strong>ï¼šå¦‚æœ <code>UIViewController</code> çš„ <code>view</code> æ˜¯ <code>UIWindow</code> çš„ <code>root view</code> ä¸‹ä¸€ä¸ªå“åº”è€…å¯¹è±¡æ˜¯ <code>window</code>ï¼›å¦‚æœ å½“å‰ <code>UIViewController</code> ç”±å¦ä¸€ä¸ª <code>UIViewController push</code> æˆ–è€… <code>presented</code>ï¼Œåˆ™ä¸‹ä¸€ä¸ªå“åº”è€…ä¸º å¼¹å‡ºè¯¥ <code>vc</code> çš„ <code>UIViewController</code>ï¼Œä¾‹å¦‚ <code>UINavigationController</code>ã€<code>UITableBarController</code>ã€‚</li>
<li><strong>UIWindow</strong>ï¼šä¸‹ä¸€ä¸ªå“åº”è€…ä¸º <code>UIApplication</code></li>
<li><strong>UIApplication</strong>ï¼šä¸‹ä¸€ä¸ªå“åº”è€…ä¸º <code>UIApplicationDelegate</code>ï¼Œå‰ææ˜¯å®ƒä¸æ˜¯ <code>UIView</code>ã€<code>UIViewController</code>ã€ä»¥åŠä¸æ˜¯ <code>UIApplication</code> æœ¬èº«ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ˜¯æŒ‡ <code>AppDelegate</code>ã€‚</li>
</ul>
<h2 id="äº‹ä»¶-amp-è°æ˜¯äº‹ä»¶çš„ç¬¬ä¸€å“åº”è€…"><a href="#äº‹ä»¶-amp-è°æ˜¯äº‹ä»¶çš„ç¬¬ä¸€å“åº”è€…" class="headerlink" title="äº‹ä»¶ &amp; è°æ˜¯äº‹ä»¶çš„ç¬¬ä¸€å“åº”è€…"></a>äº‹ä»¶ &amp; è°æ˜¯äº‹ä»¶çš„ç¬¬ä¸€å“åº”è€…</h2><table>
<thead>
<tr>
<th>äº‹ä»¶ç±»å‹</th>
<th>ç¬¬ä¸€å“åº”è€…</th>
</tr>
</thead>
<tbody><tr>
<td>è§¦æ‘¸äº‹ä»¶ touch events</td>
<td>å‘ç”Ÿè§¦æ‘¸çš„è§†å›¾</td>
</tr>
<tr>
<td>æŒ‰å‹äº‹ä»¶ press events</td>
<td>è¢«èšç„¦çš„å¯¹è±¡</td>
</tr>
<tr>
<td>æ‘‡åŠ¨äº‹ä»¶ shake-motion events</td>
<td>ä½ (or UIKit)æŒ‡å®šçš„å¯¹è±¡</td>
</tr>
<tr>
<td>è¿œç¨‹æ§åˆ¶äº‹ä»¶ remote-control event</td>
<td>ä½ (or UIKit)æŒ‡å®šçš„å¯¹è±¡</td>
</tr>
<tr>
<td>ç¼–è¾‘èœå•æ¶ˆæ¯ editing menu messages</td>
<td>ä½ (or UIKit)æŒ‡å®šçš„å¯¹è±¡</td>
</tr>
<tr>
<td>åŠ é€Ÿå™¨ accelerometers</td>
<td>å§”ä»»çš„å¯¹è±¡</td>
</tr>
<tr>
<td>é™€èº gyroscopes</td>
<td>å§”ä»»çš„å¯¹è±¡</td>
</tr>
<tr>
<td>ç£åŠ›ä»ª magnetometer</td>
<td>å§”ä»»çš„å¯¹è±¡</td>
</tr>
</tbody></table>
<p>åœ¨ iOS ä¸­ï¼Œæœ‰ 8 ç§ç±»å‹çš„äº‹ä»¶ï¼Œå“åº”è¿™äº›äº‹ä»¶çš„å¯¹è±¡è¢«ç§°ä¸ºå“åº”è€…ï¼Œç³»ç»Ÿçš„ä¸€äº›å¸¸è§çš„å“åº”è€…ä¸º <code>UIView</code>ã€<code>UIViewController</code>ã€<code>UIWindow</code>ã€<code>UIAppllication</code>ã€<code>AppDelegate</code>ï¼Œåœ¨æ‰¾åˆ°æœ€ä½³å“åº”è€…åï¼Œå¦‚æœäº‹ä»¶æ²¡æœ‰è¢«å¤„ç†ï¼Œäº‹ä»¶ä¼šéšç€å“åº”è€…é“¾è¿›è¡Œä¼ é€’ã€‚ä¸è¿‡æœ‰äº›äº‹ä»¶åœ¨è¿›è¡Œä¼ é€’çš„æ—¶å€™ï¼Œå³ä½¿é‡å†™äº†å“åº”äº‹ä»¶çš„æ–¹æ³•ï¼Œç‰¹å®šå¯¹è±¡ä¸ä¼šè¿›è¡Œå“åº”ï¼Œä¾‹å¦‚ <code>shake-motion events</code> ä¸ä¼šç”± <code>UIView</code>ã€<code>UIApplication</code>ã€<code>AppDelegate</code> è¿›è¡Œå“åº”ã€‚</p>
<ul>
<li>è§¦æ‘¸äº‹ä»¶ <code>touch events</code>ï¼Œæ˜¯ iOS ä¸­æœ€å¸¸è§çš„äº‹ä»¶ï¼Œæ¯ä¸€æ¬¡è§¦ç¢°éƒ½ä¼šç”± IOKit é€šè¿‡ IPC äº¤ç»™ SpringBoardï¼Œè¿›è€Œé€šè¿‡ <code>mach port</code> ä¼ é€’ç»™åˆé€‚çš„è¿›ç¨‹è¿›è¡Œå“åº”ï¼Œç¬¬ä¸€å“åº”è€…æ˜¯å‘ç”Ÿè§¦ç¢°çš„è§†å›¾ï¼Œåé¢ä¼šé‡ç‚¹è®²è§£ã€‚</li>
</ul>
<pre><code class="swift">open func touchesBegan(_ touches: Set&lt;UITouch&gt;, with event: UIEvent?)
open func touchesMoved(_ touches: Set&lt;UITouch&gt;, with event: UIEvent?)
open func touchesEnded(_ touches: Set&lt;UITouch&gt;, with event: UIEvent?)
open func touchesCancelled(_ touches: Set&lt;UITouch&gt;, with event: UIEvent?)
@available(iOS 9.1, *)
open func touchesEstimatedPropertiesUpdated(_ touches: Set&lt;UITouch&gt;)
</code></pre>
<ul>
<li>æŒ‰å‹äº‹ä»¶<code>press events</code>ï¼Œè¡¨ç¤ºå¦‚é¥æ§å™¨æˆ–è€…æ¸¸æˆæ‰‹æŸ„ä¸­è¿›è¡ŒæŒ‰å‹è§¦ç¢°è€Œäº§ç”Ÿçš„äº‹ä»¶ï¼Œç”±å½“å‰èšç„¦çš„å¯¹è±¡è¿›è¡Œå“åº”ã€‚</li>
</ul>
<pre><code class="swift">@available(iOS 9.0, *)
open func pressesBegan(_ presses: Set&lt;UIPress&gt;, with event: UIPressesEvent?)
@available(iOS 9.0, *)
open func pressesChanged(_ presses: Set&lt;UIPress&gt;, with event: UIPressesEvent?)
@available(iOS 9.0, *)
open func pressesEnded(_ presses: Set&lt;UIPress&gt;, with event: UIPressesEvent?)
@available(iOS 9.0, *)
open func pressesCancelled(_ presses: Set&lt;UIPress&gt;, with event: UIPressesEvent?)
</code></pre>
<ul>
<li>æ‘‡åŠ¨äº‹ä»¶ <code>shake-motion events</code>ï¼Œæ™ƒåŠ¨è®¾å¤‡è¿›è¡Œè§¦å‘ã€‚</li>
</ul>
<pre><code class="swift">open func motionBegan(_ motion: UIEvent.EventSubtype, with event: UIEvent?)
open func motionEnded(_ motion: UIEvent.EventSubtype, with event: UIEvent?) 
open func motionCancelled(_ motion: UIEvent.EventSubtype, with event: UIEvent?)
</code></pre>
<ul>
<li>è¿œç¨‹æ§åˆ¶äº‹ä»¶ <code>remote-control event</code>ï¼Œåœ¨éŸ³è§†é¢‘æ’­æ”¾æ—¶ï¼Œé”å±ç•Œé¢æˆ–è€…æ§åˆ¶ä¸­å¿ƒä¸­ç‚¹å‡» â€œä¸Šä¸€ä¸ªâ€ã€â€œä¸‹ä¸€ä¸ªâ€ã€â€œæš‚åœâ€å’Œâ€œç»§ç»­â€ç­‰æ“ä½œæ—¶è§¦å‘çš„äº‹ä»¶ã€‚</li>
</ul>
<pre><code class="swift">@available(iOS 4.0, *)
open func remoteControlReceived(with event: UIEvent?)
</code></pre>
<ul>
<li>ç¼–è¾‘èœå•æ¶ˆæ¯ <code>editing menu messages</code>ï¼Œç¼–è¾‘æ–‡æœ¬å‡ºç°çš„èœå•åˆ—è¡¨äº§ç”Ÿçš„äº‹ä»¶ã€‚</li>
</ul>
<pre><code class="swift">open func buildMenu(with builder: UIMenuBuilder)
@available(iOS 13.0, *)
open func validate(_ command: UICommand)
@available(iOS 3.0, *)
open var undoManager: UndoManager? { get }
@available(iOS 13.0, *)
open var editingInteractionConfiguration: UIEditingInteractionConfiguration { get }
</code></pre>
<ul>
<li>åŠ é€Ÿå™¨äº‹ä»¶ã€é™€èºäº‹ä»¶ã€ç£åŠ›ä»ªäº‹ä»¶ä¸è·Ÿéšå“åº”è€…é“¾ï¼Œ<code>Core Motion</code> å°†è¿™äº›äº‹ä»¶ç›´æ¥ä¼ é€’ç»™æŒ‡å®šçš„å§”ä»»å¯¹è±¡ã€‚</li>
</ul>
<h2 id="è§¦æ‘¸äº‹ä»¶æµç¨‹"><a href="#è§¦æ‘¸äº‹ä»¶æµç¨‹" class="headerlink" title="è§¦æ‘¸äº‹ä»¶æµç¨‹"></a>è§¦æ‘¸äº‹ä»¶æµç¨‹</h2><img src="/images/blog/image-20220620215940554.png" alt="image-20220620215940554" style="zoom:80%;">

<p>å½“è§¦æ‘¸äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œè¢«ç”¨æˆ·é¢æ¿å³ç¡¬ä»¶ç”±ç”µä¿¡å·é‡‡é›†åˆ°ï¼Œä¹‹åå†ä¼ é€’ç»™ <code>IOKit.framework</code>ï¼Œå¹¶å°†äº‹ä»¶å°è£…ä¸º <code>IOHIDEvent</code>ï¼›ä¹‹åé€šè¿‡ IPC è½¬å‘ç»™ <code>SpringBoard</code> è¿›ç¨‹ï¼›å†ç”± <code>SpringBoard</code> è¿›ç¨‹å†æ¬¡é€šè¿‡ <code>IPC</code> å°†äº‹ä»¶ä¼ é€’ç»™åˆé€‚çš„ APP è¿›ç¨‹ï¼›ç”±ä¸»çº¿ç¨‹ <code>RunLoop</code> è¿›è¡Œå¤„ç†ï¼Œå…ˆè§¦å‘ <code>source1</code> å›è°ƒï¼Œåè§¦å‘äº† <code>source0</code> å›è°ƒï¼Œå¹¶å°†äº‹ä»¶å°è£…ä¸º <code>UIEvent</code>ï¼›ç„¶åå°†äº‹ä»¶åŠ å…¥ <code>UIApplication</code> å¯¹è±¡çš„äº‹ä»¶é˜Ÿåˆ—ä¸­ï¼Œå‡ºé˜Ÿåï¼Œå¼€å§‹å¯»æ‰¾æœ€ä½³å“åº”è€… <code>hit-Testing</code>ï¼Œæ‰¾åˆ°æœ€ä½³å“åº”è€…åã€‚ç”± <code>UIApplication</code> å¯¹è±¡ ä» <code>sendEvent</code> æ–¹æ³•å°†äº‹ä»¶ä¼ é€’ç»™ <code>window</code> å¯¹è±¡ï¼Œå†ç”± <code>window</code> å¯¹è±¡ <code>sendEvent</code> åˆ°æœ€ä½³å“åº”è€…ï¼Œéšåè¿›è¡Œäº‹ä»¶å“åº”ä»¥åŠä¼ é€’ã€‚å¯»æ‰¾æœ€ä½³å“åº”è€…ä»¥åŠäº‹ä»¶å“åº”åé¢ä¼šé‡ç‚¹æåŠï¼Œè¿™é‡Œå…ˆç®€å•å¯¹ IOKit.frameworkã€SpringBoard ä»¥åŠ IPC è¿›è¡Œç®€å•ä»‹ç»ï¼š</p>
<ul>
<li>IOKit.frameworkï¼šå®ƒä¸ºè®¾å¤‡é©±åŠ¨ç¨‹åº(IOKit)çš„ç”¨æˆ·æ€ç»„ä»¶ï¼ŒIOKit æ¥æºäº NeXTSTEP çš„ DriverKitï¼ŒIOKit.framework æä¾›äº†å†…æ ¸æ€ä»¥åŠç”¨æˆ·æ€åŒå‘é€šä¿¡çš„æ¥å£ã€‚</li>
<li>SpringBoardï¼šiOS ä¸­çš„ SpringBoard ç›¸å½“äº macOS ä¸­çš„ Finderï¼Œå®ƒå‘ç”¨æˆ·æä¾›äº†ç†Ÿæ‚‰çš„å›¾æ ‡ç•Œé¢ï¼Œå®ƒè®°å½•äº†å¤šè§¦æ‘¸äº‹ä»¶ã€åŠ é€Ÿå™¨äº‹ä»¶ã€æŒ‰å‹äº‹ä»¶ç­‰ã€‚</li>
<li>IPCï¼šmacOS å’Œ iOS ä¸­çš„è¿›ç¨‹é—´é€šä¿¡(InterProcess Communication) æ˜¯åŸºäº machï¼Œmach æ˜¯ iOS å’Œ macOS ä¸­çš„æ ¸å¿ƒï¼Œä¹Ÿæ˜¯æœ‰åˆ«äºå…¶ä»–æ“ä½œç³»ç»Ÿçš„é‡ç‚¹ï¼Œmach é‡‡ç”¨å¾®å†…æ ¸çš„æ¦‚å¿µï¼Œå³å†…æ ¸ä»…æä¾›ä¸€äº›å¿…è¦çš„åŠŸèƒ½ï¼Œå…¶ä»–å·¥ä½œç”±ç”¨æˆ·æ€å®ç°ã€‚mach çš„ IPC æ˜¯é€šè¿‡åœ¨ä¸¤ä¸ªç«¯å£ä¹‹é—´å‘é€æ¶ˆæ¯å®ç°ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ ã€Šæ·±å…¥è§£æMac OS X &amp; iOS æ“ä½œç³»ç»Ÿã€‹ã€‚</li>
</ul>
<h3 id="å¯»æ‰¾æœ€ä½³å“åº”è€…"><a href="#å¯»æ‰¾æœ€ä½³å“åº”è€…" class="headerlink" title="å¯»æ‰¾æœ€ä½³å“åº”è€…"></a>å¯»æ‰¾æœ€ä½³å“åº”è€…</h3><ol>
<li>ç”± <code>UIApplication</code> ä¼ é€’ç»™ <code>UIWindow</code>ï¼Œå¦‚æœæœ‰å¤šä¸ª <code>UIWindow</code> å¯¹è±¡ï¼Œåˆ™æŒ‰å€’åºè¿›è¡ŒæŸ¥è¯¢ã€‚</li>
<li>å¯¹äºæ¯ä¸€ä¸ª <code>UIWindow</code>ã€<code>UIView</code> å¯¹è±¡æ¥è¯´ï¼Œä¹Ÿæ˜¯å€’å™æŸ¥è¯¢å…¶å­è§†å›¾å’Œæœ¬è§†å›¾èƒ½å¦å“åº”ã€‚</li>
</ol>
<p>å¦‚æœä»éå†æ–¹å¼æ¥çœ‹ï¼Œæ˜¯ä¸€ä¸ªåè¿‡æ¥çš„ <code>dfs</code>ã€‚å€’å™æ˜¯å› ä¸ºå¦‚æœæœ‰è§†å›¾é‡å ï¼Œåœ¨ä¸Šæ–¹çš„æ˜¯ååŠ å…¥çš„å¯¹è±¡ï¼›å…·ä½“æ¥è¯´éƒ½æ˜¯é€šè¿‡ <code>UIView</code> çš„ <code>hitTest</code> æ–¹æ³•è¿›è¡Œåˆ¤æ–­æ˜¯ä¸æ˜¯æœ€ä½³å“åº”è€…ï¼Œå¦‚æœå­˜åœ¨åˆ™è¿”å›è¯¥ <code>UIView</code>ï¼Œä¸å­˜åœ¨åˆ™è¿”å› <code>nil</code>ã€‚</p>
<ul>
<li><code>hitTest(_ point: CGPoint, with event: UIEvent?)</code> <strong>æ¨¡æ‹Ÿä»£ç </strong></li>
</ul>
<pre><code class="swift">override func hitTest(_ point: CGPoint, with event: UIEvent?) -&gt; UIView? {
    guard self.isUserInteractionEnabled &amp;&amp; !self.isHidden &amp;&amp; self.alpha &gt; 0.01 else {
        return nil
    }
    if self.point(inside: point, with: event) {
        for subview in subviews.reversed() {
            let convertedPoint = subview.convert(point, from: self)
            let hitTestView = subview.hitTest(convertedPoint, with: event)
            if let hitTestView = hitTestView {
                return hitTestView
            }
        }
      return self
    }
    return nil
}
</code></pre>
<ol>
<li><p>éœ€è¦ <code>isUserInteractionEnabled</code> ä¸º <code>true</code>ã€<code>isHidden</code> ä¸º <code>fasle</code> ä¸”é€æ˜åº¦ &gt; 0.01</p>
</li>
<li><p>å¦‚æœå‘½ä¸­ç‚¹åœ¨è§†å›¾å†…ï¼Œå°è¯•å€’åºéå†å­è§†å›¾ï¼ŒæŸ¥æ‰¾æ˜¯å¦æœ‰æ›´åˆé€‚çš„ç‚¹ï¼Œè‹¥æœ‰åˆ™è¿”å›å­è§†å›¾çš„ <code>hitTest()</code>ï¼Œè‹¥æ— åˆ™è¿”å›æœ¬è§†å›¾(<code>self</code>)ã€‚</p>
</li>
<li><p>å¦‚æœå‘½ä¸­ç‚¹ä¸åœ¨è§†å›¾å†…ï¼Œåˆ™è¿”å› <code>nil</code>ã€‚</p>
</li>
</ol>
<ul>
<li><code>point(inside point: CGPoint, with event: UIEvent?)</code> <strong>æ¨¡æ‹Ÿä»£ç </strong></li>
</ul>
<pre><code class="swift">override func point(inside point: CGPoint, with event: UIEvent?) -&gt; Bool {
    return bounds.contains(point)
}
</code></pre>
<ol>
<li>åˆ¤æ–­å½“å‰ bounds æ˜¯å¦åŒ…å«è¯¥ç‚¹ã€‚</li>
</ol>
<h3 id="è§¦æ‘¸äº‹ä»¶çš„å“åº”ä»¥åŠä¼ é€’"><a href="#è§¦æ‘¸äº‹ä»¶çš„å“åº”ä»¥åŠä¼ é€’" class="headerlink" title="è§¦æ‘¸äº‹ä»¶çš„å“åº”ä»¥åŠä¼ é€’"></a>è§¦æ‘¸äº‹ä»¶çš„å“åº”ä»¥åŠä¼ é€’</h3><p>æ‰¾åˆ°æœ€ä½³å“åº”è€…åï¼Œ<code>UIApplication</code> å¯¹è±¡ <code>sendEvent</code> åˆ°å“åº”è¯¥è§†å›¾çš„ <code>UIWindow</code>ï¼Œå†æœ‰ <code>UIWindow</code> å¯¹è±¡ <code>sendEvent</code> åˆ°æœ€ä½³å“åº”è€…ï¼Œè¿™ä¸€ç‚¹å¯ä»¥é€šè¿‡æŸ¥çœ‹è°ƒç”¨æ ˆå¸§çœ‹å‡ºï¼š</p>
<img src="/images/blog/image-20220704022615988.png" alt="image-20220704022615988" style="zoom:100%;">

<p>ä¼ é€’ç»™æœ€ä½³å“åº”è€…åï¼Œä¾¿å¯ä»¥è¿›è¡Œäº‹ä»¶çš„å“åº”äº†ï¼Œå¯¹äºè§¦æ‘¸äº‹ä»¶æ¥è¯´ï¼Œè°ƒç”¨ä¸Šè¿°æåˆ°çš„ 5 ä¸ªæ–¹æ³•å³ä»£è¡¨å“åº”ã€‚äº‹ä»¶çš„æ‹¦æˆªæ˜¯é€šè¿‡ <code>open func touchesBegan(_ touches: Set&lt;UITouch&gt;, with event: UIEvent?)</code> å®ç°çš„ï¼Œä¼ é€’æ–¹å¼ä¸è§„åˆ™è§ä¸Šæ–‡ä¸­ <strong>å“åº”è€… &amp; å“åº”è€…é“¾</strong>ï¼š</p>
<ul>
<li>ä¸é‡å†™ï¼Œé»˜è®¤å°†äº‹ä»¶äº¤ç»™å“åº”è€…é“¾ä¼ é€’</li>
<li>é‡å†™ä¸æ‰ç”¨ <code>super.touchesBegan(touches, with: event)</code>ï¼Œäº‹ä»¶ç”±è¯¥å“åº”è€…å¤„ç†ï¼Œä¸è¿›è¡Œä¼ é€’</li>
<li>é‡å†™å¹¶è°ƒç”¨ <code>super.touchesBegan(touches, with: event)</code>ï¼Œå°†äº‹ä»¶äº¤ç»™å“åº”è€…é“¾ä¼ é€’</li>
</ul>
<p>é‡‡ç”¨ <code>touchesBegan</code> ç­‰ç³»åˆ—æ–¹æ³•ä»¥å“åº”ç®—æ˜¯æ¯”è¾ƒåº•å±‚çš„æ–¹å¼ï¼Œä¸ºå¿«é€Ÿå“åº”å„ç§ç±»å‹çš„è§¦æ‘¸äº‹ä»¶ï¼ŒApple æä¾›äº† <code>UIGestureRecognizer</code> ä¸ <code>UIControl</code> è¿™ä¸¤ç§æ–¹å¼ã€‚</p>
<h4 id="UIGestureRecognizer"><a href="#UIGestureRecognizer" class="headerlink" title="UIGestureRecognizer"></a>UIGestureRecognizer</h4><p>UIGestureRecognizer æ‰‹åŠ¿è¯†åˆ«å™¨æ˜¯å¤„ç†è§†å›¾ä¸­çš„è§¦æ‘¸å’ŒæŒ‰å‹äº‹ä»¶çš„æœ€å¥½æ–¹å¼ï¼Œå¦‚æœæˆ‘ä»¬ä»…ç”¨è§¦æ‘¸äº‹ä»¶åŸºæœ¬å“åº”æ–¹å¼è¿›è¡Œå¤„ç†çš„è¯ï¼Œéš¾åº¦è¾ƒå¤§ä¸”ä¸ç°å®ã€‚å®ƒæ˜¯ä¸€ä¸ªåŸºç±»ï¼ŒApple æä¾›äº† 8 ç§æ‰‹åŠ¿ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥åˆ›å»ºè‡ªå®šä¹‰æ‰‹åŠ¿ã€‚</p>
<ul>
<li><code>UITapGestureRecognizer</code>ï¼šè½»ç‚¹æ‰‹åŠ¿</li>
<li><code>UIPinchGestureRecognizer</code>ï¼šæåˆæ‰‹åŠ¿</li>
<li><code>UIRotationGestureRecognizer</code>ï¼šæ—‹è½¬æ‰‹åŠ¿</li>
<li><code>UISwipeGestureRecognizer</code>ï¼šæ»‘åŠ¨æ‰‹åŠ¿</li>
<li><code>UIPanGestureRecognizer</code>ï¼šæ‹–æ‹½æ‰‹åŠ¿</li>
<li><code>UIScreenEdgePanGestureRecognizer</code>ï¼šå±å¹•è¾¹ç¼˜æ‹–æ‹½æ‰‹åŠ¿</li>
<li><code>UILongPressGestureRecognizer</code>ï¼šé•¿æŒ‰æ‰‹åŠ¿</li>
<li><code>UIHoverGestureRecognizer</code>ï¼šæŒ‡é’ˆæ‚¬åœï¼ˆmacOS &amp; iPadOSï¼‰</li>
</ul>
<p>æ‰‹åŠ¿è¯†åˆ«å™¨åˆ†ä¸ºç¦»æ•£å‹å’ŒæŒç»­æ€§ä¸¤ç§ï¼š</p>
<p>ç¦»æ•£å‹æ‰‹åŠ¿åœ¨è¯†åˆ«åˆ°æ‰‹åŠ¿ååªè°ƒç”¨ä¸€æ¬¡ <code>action</code> æ–¹æ³•ï¼Œå…¶å˜åŒ–è¿‡ç¨‹ä¸ºï¼š</p>
<ul>
<li><p>è¯†åˆ«æˆåŠŸï¼šPossible â€”&gt; Recognized</p>
</li>
<li><p>è¯†åˆ«å¤±è´¥ï¼šPossible â€”&gt; Failed</p>
</li>
</ul>
<p>æŒç»­æ€§æ‰‹åŠ¿åœ¨æ»¡è¶³æœ€åˆå§‹è¯†åˆ«æ¡ä»¶åï¼Œä¼šåœ¨æ‰‹åŠ¿ä¿¡æ¯å˜åŒ–ä¸­å¤šæ¬¡è°ƒç”¨ action æ–¹æ³•ï¼Œå…¶å˜åŒ–è¿‡ç¨‹ä¸ºï¼š</p>
<ul>
<li><p>å®Œæ•´è¯†åˆ«ï¼šPossible â€”&gt; Began â€”&gt; [Changed] â€”&gt; Ended</p>
</li>
<li><p>ä¸å®Œæ•´è¯†åˆ«ï¼šPossible â€”&gt; Began â€”&gt; [Changed] â€”&gt; Cancel</p>
</li>
</ul>
<p><strong>å¯¹äº UIResponder çš„è§¦æ‘¸å“åº”ä¼˜å…ˆçº§æ¥è¯´ï¼ŒUIGestureRecognizer çš„å“åº”ä¼˜å…ˆçº§ä¼šæ›´é«˜ä¸€ç‚¹</strong>ï¼›åœ¨ hit-Testing è¿‡ç¨‹ä¸­ï¼Œå°±ä¼šåˆ¤æ–­å½“å‰ <code>view</code> çš„æ‰‹åŠ¿è¯†åˆ«å™¨æ˜¯å¦ç¬¦åˆæ¡ä»¶ï¼Œç¬¦åˆæ¡ä»¶çš„æ‰‹åŠ¿è¯†åˆ«å™¨å¯¹è±¡ä¼šä¿å­˜åœ¨ <code>UIEvent</code> ä¸­ï¼Œå¹¶åœ¨ <code>sendEvent</code> æ—¶é¦–å…ˆå‘é€ç»™å®ƒï¼Œå¦‚æœæ‰‹åŠ¿è¯†åˆ«å™¨è¯†åˆ«æˆåŠŸï¼Œåˆ™é»˜è®¤ä¼šå–æ¶ˆå‰©ä½™çš„è§¦æ‘¸å“åº”äº‹ä»¶ï¼Œè¡¨ç°ä¸ºè°ƒç”¨ <code>touchesCancelled</code> æ–¹æ³•ã€‚</p>
<p>ä¸‰ä¸ªé‡è¦çš„å±æ€§ä¼šæ”¹å˜ä¸Šè¿°è¿‡ç¨‹ï¼š</p>
<ul>
<li><code>cancelsTouchesInView</code>ï¼šé»˜è®¤ä¸º trueï¼Œè¡¨ç¤ºåœ¨è¯†åˆ«æ‰‹åŠ¿æˆåŠŸåï¼Œæ˜¯å¦å–æ¶ˆå‰©ä½™çš„è§¦æ‘¸å“åº”äº‹ä»¶ï¼›</li>
<li><code>delaysTouchesBegan</code>ï¼šé»˜è®¤ä¸º falseï¼Œè¡¨ç¤ºæ˜¯å¦åœ¨è¯†åˆ«æ‰‹åŠ¿å¤±è´¥åï¼Œæ‰å°†è§¦æ‘¸äº‹ä»¶ä¼ é€’ç»™ <code>hit-Tested view</code>ï¼›</li>
<li><code>delaysTouchesEnded</code>ï¼šé»˜è®¤ä¸º trueï¼Œè¡¨ç¤ºæ˜¯å¦åœ¨è¯†åˆ«æ‰‹åŠ¿å¤±è´¥åï¼Œæ‰å°† <code>touchesEnded</code> äº‹ä»¶å‘é€ç»™ <code>hit-Tested view</code>ï¼›</li>
</ul>
<p>æ‰‹åŠ¿å†²çª</p>
<p>æ‰‹åŠ¿é»˜è®¤æ˜¯äº’æ–¥çš„ï¼Œä½†å¯ä»¥åˆ©ç”¨ <code>UIGestureRecognizerDelegate</code> è¿›è¡Œæ‰‹åŠ¿ä¼˜å…ˆçº§å¤„ç†ã€‚</p>
<h4 id="UIControl"><a href="#UIControl" class="headerlink" title="UIControl"></a>UIControl</h4><p>UIControl æ˜¯å“åº”ç‰¹å®šåŠ¨ä½œæˆ–æ„å›¾çš„è§†è§‰å…ƒç´ çš„æ§ä»¶åŸºç±»ï¼Œå®ƒæ˜¯ <code>UIView</code> çš„å­ç±»ï¼Œå› æ­¤å®ƒä¹Ÿæ˜¯å“åº”è€…å¯¹è±¡ï¼›<code>UIButton</code>ã€<code>UISwitch</code>ã€<code>UISlider</code> ç­‰éƒ½æ˜¯å®ƒçš„å­ç±»ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰ <code>UIControl</code>ã€‚é€šè¿‡  <code>addTarget(_:action:for:)</code> æŒ‡å®šå“åº”äº‹ä»¶å’Œå¯¹è±¡å’Œæ–¹æ³•ï¼Œå¦‚æœ <code>target</code> ä¸º <code>nil</code>ï¼Œåˆ™æŒ‰ç…§å“åº”é“¾ä¼ é€’è¯¥äº‹ä»¶ã€‚</p>
<pre><code class="swift">open func beginTracking(_ touch: UITouch, with event: UIEvent?) -&gt; Bool
open func continueTracking(_ touch: UITouch, with event: UIEvent?) -&gt; Bool
open func endTracking(_ touch: UITouch?, with event: UIEvent?) // touch is sometimes nil if cancelTracking calls through to this.
open func cancelTracking(with event: UIEvent?) // event may be nil if cancelled for non-event reasons, e.g. removed from window
</code></pre>
<p>ä¸ <code>UIResponder</code> ç±»ä¼¼ï¼Œ<code>UIControl</code> æœ‰ 4 ç§è·Ÿè¸ªè§¦æ‘¸äº‹ä»¶çš„æ–¹æ³•ï¼Œåˆ†åˆ«ä¸ <code>UIResponder</code> çš„ <code>began</code>ã€<code>moved</code>ã€<code>ended</code>ã€<code>cancelled</code> ç›¸å¯¹åº”ã€‚å¦‚æœæŸ¥çœ‹å…¶è°ƒç”¨æ ˆï¼Œå¯ä»¥å‘ç°åœ¨ <code>UIResponder</code> æ–¹æ³•å†…éƒ¨è°ƒç”¨äº† <code>UIControl</code> çš„è·Ÿè¸ªæ–¹æ³•ã€‚</p>
<p><img src="/images/blog/image-20220707113956921.png" alt="image-20220707113956921"></p>
<p>å¦‚æœåœ¨å“åº”äº‹ä»¶çš„æ–¹æ³•æ‰“æ–­ç‚¹ï¼ŒæŸ¥çœ‹è°ƒç”¨æ ˆå¸§ï¼Œä¼šå‘ç° <code>UIControl</code> ä¼šé¦–å…ˆå°†äº‹ä»¶é€šè¿‡ <code>sendAction:to:forEvent:</code> å‘é€ç»™ <code>UIApplication</code>ï¼Œå†é€šè¿‡ <code>sendAction</code> è½¬å‘ç»™å‘é€çš„å¯¹è±¡çš„å¯¹è±¡ã€‚</p>
<p><img src="/images/blog/image-20220707114606464.png" alt="image-20220707114606464"></p>
<p>ä¸ <code>UIGestureRecognizer</code> ç›¸æ¯”ï¼Œäº‹ä»¶ä»ä¼šä¼˜å…ˆä¼ é€’åˆ° <code>UIGestureRecognizer</code>ï¼Œè¿™ä¸€ç‚¹å¯ä»¥é‡å†™ <code>UIGestureRecognizer</code> çš„ 4 ä¸ªå“åº”æ–¹æ³•éªŒè¯ã€‚</p>
<p>å¦‚æœ <code>UIControl</code> æ˜¯å…¶å­è§†å›¾ï¼Œä¼šåˆ¤æ–­å…¶æ˜¯å¦ä¸ºç³»ç»Ÿé»˜è®¤æ§ä»¶ï¼Œç³»ç»Ÿé»˜è®¤æ§ä»¶åˆ™ä¼˜å…ˆå“åº” <code>UIControl</code> çš„ <code>action</code> æ–¹æ³•ï¼Œå¦‚æœä¸ºè‡ªå®šä¹‰æ§ä»¶ï¼Œåˆ™é»˜è®¤ä¼˜å…ˆå“åº” <code>UIGestureRecognizer</code> çš„ <code>action</code>ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœå°† <code>UIGestureRecognizer</code> çš„ <code>cancelsTouchesInView</code> æ”¹ä¸º<code> false</code>(é»˜è®¤ä¸º <code>true</code>)ï¼Œåˆ™å‘ç° <code>UIGestureRecognizer</code> ä¹Ÿä¼šè¿›è¡Œå“åº”ï¼Œä¸ªäººç†è§£ä¸º <code>cancelsTouchesInView</code> æ”¹å˜äº†å“åº”äº’æ–¥çš„ç‰¹æ€§ï¼Œå› æ­¤æœ¬èº«ä¹Ÿä¼šå“åº”ã€‚ </p>
<p>å¦‚æœ <code>UIControl</code> ä¸ºçˆ¶è§†å›¾æˆ–å¹³çº§è§†å›¾ï¼Œç”±äºä»ä¼šä¼˜å…ˆå°†äº‹ä»¶ä¼ é€’åˆ° <code>UIGestureRecognizer</code>ï¼Œ åˆ™å¯ä»¥æ ¹æ®å…¶ <code>cancelsTouchesInView</code>ã€<code>delaysTouchesBegan</code>ã€<code>delaysTouchesEnded</code> åˆ¤æ–­äº‹ä»¶èƒ½å¦ä¼ é€’åˆ° <code>UIControl</code>ï¼Œè¿™ä¸€ç‚¹ <code>UIControl</code> ä¸ <code>UIResponder</code> ä¸€è‡´ã€‚</p>
<h3 id="åº”ç”¨å®è·µ"><a href="#åº”ç”¨å®è·µ" class="headerlink" title="åº”ç”¨å®è·µ"></a>åº”ç”¨å®è·µ</h3><h4 id="æ‰©å¤§å“åº”åŒºåŸŸ"><a href="#æ‰©å¤§å“åº”åŒºåŸŸ" class="headerlink" title="æ‰©å¤§å“åº”åŒºåŸŸ"></a>æ‰©å¤§å“åº”åŒºåŸŸ</h4><ol>
<li>é‡å†™æœ¬è§†å›¾çš„ <code>func point(inside point: CGPoint, with event: UIEvent?) -&gt; Bool</code> </li>
</ol>
<pre><code class="swift">override func point(inside point: CGPoint, with event: UIEvent?) -&gt; Bool {
    // å°†å“åº”åŒºåŸŸæ‰©å¤§ 30
    return self.bounds.inset(by: .init(top: -30, left: -30, bottom: -30, right: -30)).contains(point)
}
</code></pre>
<ol start="2">
<li>é‡å†™çˆ¶è§†å›¾çš„ <code>func hitTest(_ point: CGPoint, with event: UIEvent?) -&gt; UIView?</code></li>
</ol>
<pre><code class="swift">override func hitTest(_ point: CGPoint, with event: UIEvent?) -&gt; UIView? {
    // å°†å“åº”åŒºåŸŸæ‰©å¤§ 30
    // subView ä¸ºåº”æ‰©å¤§å“åº”åŒºåŸŸçš„è§†å›¾
    if subView.frame.inset(by: .init(top: -30, left: -30, bottom: -30, right: -30)).contains(point) {
        return subView
    }
    return super.hitTest(point, with: event)
}
</code></pre>
<h4 id="æ ¹æ®è§¦æ‘¸å®æ—¶ä¿®æ”¹-view-ä½ç½®"><a href="#æ ¹æ®è§¦æ‘¸å®æ—¶ä¿®æ”¹-view-ä½ç½®" class="headerlink" title="æ ¹æ®è§¦æ‘¸å®æ—¶ä¿®æ”¹ view ä½ç½®"></a>æ ¹æ®è§¦æ‘¸å®æ—¶ä¿®æ”¹ view ä½ç½®</h4><pre><code class="swift">override func touchesMoved(_ touches: Set&lt;UITouch&gt;, with event: UIEvent?) {
    let touch = touches.randomElement()
    let prePoint = touch?.precisePreviousLocation(in: self)
    let currPoint = touch?.location(in: self)
    if let prePoint = prePoint, let currPoint = currPoint {
        let offsetX = currPoint.x - prePoint.x
        let offsetY = currPoint.y - prePoint.y
        self.transform = self.transform.translatedBy(x: offsetX, y: offsetY)
    }
}
</code></pre>
<h2 id="ğŸ”—"><a href="#ğŸ”—" class="headerlink" title="ğŸ”—"></a>ğŸ”—</h2><p><a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/uikit/touches_presses_and_gestures/using_responders_and_the_responder_chain_to_handle_events">Using Responders and the Responder Chain to Handle Events</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/c294d1bd963d">iOS è§¦æ‘¸äº‹ä»¶å…¨å®¶æ¡¶</a></p>
<p><a target="_blank" rel="noopener" href="https://developer.apple.com/documentation/uikit/uigesturerecognizer?language=objc">Apple - UIGestureRecognizer</a></p>
<p><a target="_blank" rel="noopener" href="http://southpeak.github.io/2015/12/13/cocoa-uikit-uicontrol/">UIKit: UIControl</a></p>
<p>ã€Šæ·±å…¥è§£æMac OS X &amp; iOS æ“ä½œç³»ç»Ÿã€‹</p>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2022/12/20/CocoaPods%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/" title="CocoaPodsä½¿ç”¨æŒ‡å—"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">Previous: CocoaPodsä½¿ç”¨æŒ‡å—</span></a><a class="button is-default" href="/2022/06/01/debugging_in_xcode/" title="Xcode ä¸­çš„è°ƒè¯•æŠ€å·§"><span class="has-text-weight-semibold">Next: Xcode ä¸­çš„è°ƒè¯•æŠ€å·§</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section><article class="mt-6 comment-container"><script async repo="xuhaodong1/xuhaodong1.github.io" src="https://utteranc.es/client.js" issue-term="pathname" theme="preferred-color-scheme"></script></article></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/xuhaodong1"><i class="iconfont icon-github"></i></a><!-- Ins--><!-- RSS--><!-- çŸ¥ä¹--><!-- é¢†è‹±--><!-- è„¸ä¹¦--></section><p> <span>PV:</span><span id="busuanzi_value_site_pv"></span><span>  UV: </span><span id="busuanzi_value_site_uv"></span></p><p><span>Copyright Â©</span><span> nihao 2022</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" rel="noopener" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" rel="noopener" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span></span></div></footer><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/post.js"></script></body></html>